{% extends "wagtailadmin/generic/form.html" %}
{% load i18n wagtailadmin_tags static %}

{% block titletag %}{% trans "Add a document" %}{% endblock %}

{% block extra_js %}
    {{ block.super }}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const fileInput = document.getElementById('id_file');
            const titleInput = document.getElementById('id_title')
            if (fileInput) {
                fileInput.setAttribute('data-controller', 'w-sync');
                fileInput.setAttribute('data-w-sync-target-value', '#id_title');
                fileInput.setAttribute('data-w-sync-normalize-value', 'true');
                fileInput.setAttribute('data-w-sync-name-value', 'wagtail:documents-upload');
                fileInput.setAttribute('data-action', 'change->w-sync#apply');

            }
            if (titleInput) {
                titleInput.setAttribute('data-controller', 'w-clean');
                titleInput.setAttribute('data-w-clean-source-value', '#id_file');
                titleInput.setAttribute('data-action', 'change->w-clean#slugify');

            }

        });
    </script>
{% endblock %}

{% block form %}

    <div class="field">
        <label for="id_file">{% trans "Document file" %}</label>
        <input
            type="file"
            name="file"
            id="id_file"
            required
            accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.rtf"
        />
    </div>

    <div class="field">
        <label for="id_title">{% trans "Title" %}</label>
        <input
            type="text"
            name="title"
            id="id_title"
            required"
                                 >
                                 </div>

                                 <div class="actions">
                                                                     <button
                                                                     type="submit"
                         class="button button-longrunning"
                                             data-controller="w-progress"
                                        data-action="w-progress#activate"
                                             data-w-progress-active-value="{% trans 'Uploadingâ€¦' %}"
                                                                     >
                                                                     {% icon name="spinner" %}
                                                                     <em data-w-progress-target="label">{% trans 'Upload' %}</em>
                                                                                                                   </button>
                                                                                                                   </div>

                                                                                                       {% endblock %}
